(function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s="906b")})({"144c":function(e,t,n){const r="browser"===n("24b4")("type"),o=r?n("3e15"):e=>e;e.exports=e=>{const t={...e};return["corePath","workerPath"].forEach(n=>{"undefined"!==typeof e[n]&&(t[n]=o(t[n]))}),t}},1754:function(e,t,n){const r=n("3529"),o=n("a462"),a=n("2b3a"),i=n("83d9"),s=n("f1c1"),c=n("c39d"),u=n("895f");e.exports={defaultOptions:r,spawnWorker:o,terminateWorker:a,onMessage:i,send:s,fetchFile:c,fs:u}},"24b4":function(e,t){e.exports=e=>{const t={type:"undefined"!==typeof window&&"undefined"!==typeof window.document?"browser":"node"};return"undefined"===typeof e?t:t[e]}},"2b3a":function(e,t){e.exports=e=>{e.terminate()}},3529:function(e,t,n){(function(t){const r=n("3e15"),{version:o,dependencies:a}=n("67c5"),i=n("caaa");e.exports={...i,workerPath:"undefined"!==typeof t&&"development"===Object({NODE_ENV:"production",BASE_URL:"/"}).FFMPEG_ENV?r(`/dist/worker.dev.js?nocache=${Math.random().toString(36).slice(3)}`):`https://unpkg.com/@ffmpeg/ffmpeg@v${o}/dist/worker.min.js`,corePath:`https://unpkg.com/@ffmpeg/core@v${a["@ffmpeg/core"].substring(1)}/ffmpeg-core.js`,workerBlobURL:!0}}).call(this,n("f28c"))},"3e15":function(e,t,n){var r,o;!function(a,i){r=i,o="function"===typeof r?r.call(t,n,t,e):r,void 0===o||(e.exports=o)}(0,(function(){function e(){var e=arguments.length;if(0===e)throw new Error("resolveUrl requires at least one argument; got none.");var t=document.createElement("base");if(t.href=arguments[0],1===e)return t.href;var n=document.getElementsByTagName("head")[0];n.insertBefore(t,n.firstChild);for(var r,o=document.createElement("a"),a=1;a<e;a++)o.href=arguments[a],r=o.href,t.href=r;return n.removeChild(t),r}return e}))},"3f4f":function(e,t,n){"use strict";n.r(t);const r=(e,t)=>t.some(t=>e instanceof t);let o,a;function i(){return o||(o=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function s(){return a||(a=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const c=new WeakMap,u=new WeakMap,l=new WeakMap,d=new WeakMap,f=new WeakMap;function p(e){const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("success",o),e.removeEventListener("error",a)},o=()=>{t(y(e.result)),r()},a=()=>{n(e.error),r()};e.addEventListener("success",o),e.addEventListener("error",a)});return t.then(t=>{t instanceof IDBCursor&&c.set(t,e)}).catch(()=>{}),f.set(t,e),t}function m(e){if(u.has(e))return;const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("complete",o),e.removeEventListener("error",a),e.removeEventListener("abort",a)},o=()=>{t(),r()},a=()=>{n(e.error),r()};e.addEventListener("complete",o),e.addEventListener("error",a),e.addEventListener("abort",a)});u.set(e,t)}let g={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return u.get(e);if("objectStoreNames"===t)return e.objectStoreNames||l.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return y(e[t])},has(e,t){return e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e}};function h(e){g=e(g)}function w(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?s().includes(e)?function(...t){return e.apply(v(this),t),y(c.get(this))}:function(...t){return y(e.apply(v(this),t))}:function(t,...n){const r=e.call(v(this),t,...n);return l.set(r,t.sort?t.sort():[t]),y(r)}}function b(e){return"function"===typeof e?w(e):(e instanceof IDBTransaction&&m(e),r(e,i())?new Proxy(e,g):e)}function y(e){if(e instanceof IDBRequest)return p(e);if(d.has(e))return d.get(e);const t=b(e);return t!==e&&(d.set(e,t),f.set(t,e)),t}const v=e=>f.get(e);function x(e,t,{blocked:n,upgrade:r,blocking:o}={}){const a=indexedDB.open(e,t),i=y(a);return r&&a.addEventListener("upgradeneeded",e=>{r(y(a.result),e.oldVersion,e.newVersion,y(a.transaction))}),n&&a.addEventListener("blocked",()=>n()),o&&i.then(e=>e.addEventListener("versionchange",o)).catch(()=>{}),i}function j(e,{blocked:t}={}){const n=indexedDB.deleteDatabase(e);return t&&n.addEventListener("blocked",()=>t()),y(n).then(()=>{})}n.d(t,"openDB",(function(){return x})),n.d(t,"deleteDB",(function(){return j})),n.d(t,"unwrap",(function(){return v})),n.d(t,"wrap",(function(){return y}));const k=["get","getKey","getAll","getAllKeys","count"],D=["put","add","delete","clear"],E=new Map;function B(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(E.get(t))return E.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,o=D.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!o&&!k.includes(n))return;const a=async function(e,...t){const a=this.transaction(e,o?"readwrite":"readonly");let i=a.store;r&&(i=i.index(t.shift()));const s=i[n](...t);return o&&await a.done,s};return E.set(t,a),a}h(e=>({get:(t,n,r)=>B(t,n)||e.get(t,n,r),has:(t,n)=>!!B(t,n)||e.has(t,n)}))},"4bea":function(e,t){e.exports=(e,t)=>`${e}-${t}-${Math.random().toString(16).slice(3,8)}`},"4c54":function(e,t,n){const r=n("4bea");let o=0;e.exports=({id:e,action:t,payload:n={}})=>{let a=e;return"undefined"===typeof a&&(a=r("Job",o),o+=1),{id:a,action:t,payload:n}}},5993:function(e,t,n){const r=n("4c54"),{log:o}=n("908e"),a=n("4bea"),i=n("afc1"),s=n("144c"),{defaultOptions:c,spawnWorker:u,terminateWorker:l,onMessage:d,send:f,fetchFile:p,fs:m}=n("1754");let g=0;e.exports=(e={})=>{const t=a("Worker",g),{logger:n,progress:h,...w}=s({...c,...e}),b={},y={};let v=u(w);g+=1;const x=(e,t)=>{b[e]=t},j=(e,t)=>{y[e]=t},k=({id:e,action:n,payload:r})=>new Promise((a,i)=>{o(`[${t}]: Start ${e}, action=${n}`),x(n,a),j(n,i),f(v,{workerId:t,jobId:e,action:n,payload:r})}),D=e=>k(r({id:e,action:"load",payload:{options:w}})),E=(e,t)=>k(r({id:t,action:"syncfs",payload:{populate:e}})),B=async(e,t)=>(await E(),await m.writeFile(e,await p(t)),await E(!0),{path:`/data/${e}`}),$=async(e,t)=>(await E(!0),await m.writeFile(e,t),await E(!0),{path:`/data/${e}`}),I=async(e,t=!0)=>{const n=await m.readFile(e);return t&&await m.deleteFile(e),{data:n}},T=async e=>(await m.deleteFile(e),{path:`/data/${e}`}),L=(e,t={},n)=>k(r({id:n,action:"run",payload:{args:e,options:t}})),F=(e,t,n="",r=!0,o)=>L(`-i /data/${e} ${n} ${t}`,{input:e,output:t,del:r},o),A=(e,t,n,r,o="",a=!0,i)=>L(`-i /data/${e} -ss ${n} -to ${r} ${o} ${t}`,{input:e,output:t,del:a},i),S=async(e,t,n="",r=!0,o)=>{const a=e.reduce((e,t)=>`${e}\nfile ${t}`,"");return await $("concat_list.txt",a),L(`-f concat -safe 0 -i /data/concat_list.txt -c copy ${n} ${t}`,{del:r,output:t,input:[...e,"concat_list.txt"]},o)},M=(e,t)=>k(r({id:t,action:"FS",payload:{method:"readdir",args:[e]}})),O=async e=>(null!==v&&(await k(r({id:e,action:"terminate"})),l(v),v=null),Promise.resolve());return d(v,({workerId:e,jobId:t,status:r,action:a,data:s})=>{if("resolve"===r){o(`[${e}]: Complete ${t}`);let n=s;if("FS"===a){const{method:e,data:t}=s;n="readFile"===e?Uint8Array.from({...t,length:Object.keys(t).length}):t}b[a]({jobId:t,data:n})}else{if("reject"===r)throw y[a](s),Error(s);"progress"===r&&(i(s,h),n(s))}}),{id:t,worker:v,setResolve:x,setReject:j,load:D,syncfs:E,write:B,writeText:$,read:I,remove:T,run:L,transcode:F,trim:A,concatDemuxer:S,ls:M,terminate:O}}},"67c5":function(e){e.exports=JSON.parse('{"name":"@ffmpeg/ffmpeg","version":"0.5.2","description":"FFmpeg WebAssembly version","main":"src/index.js","directories":{"example":"examples"},"scripts":{"start":"node scripts/server.js","build":"rimraf dist && webpack --config scripts/webpack.config.prod.js","prepublishOnly":"npm run build","lint":"eslint src","wait":"rimraf dist && wait-on http://localhost:3000/dist/ffmpeg.dev.js","test":"npm-run-all -p -r start test:all","test:all":"npm-run-all wait test:node:all","test:node":"nyc mocha --exit --bail --require ./scripts/test-helper.js","test:node:all":"npm run test:node -- ./tests/*.test.js","test:browser":"mocha-headless-chrome -a incognito -a no-sandbox -a disable-setuid-sandbox -a disable-logging -t 300000","test:browser:ffmpeg":"npm run test:browser -- -f ./tests/ffmpeg.test.html"},"browser":{"./src/worker/node/index.js":"./src/worker/browser/index.js"},"repository":{"type":"git","url":"git+https://github.com/ffmpegjs/ffmpeg.js.git"},"keywords":["ffmpeg","WebAssembly","video"],"author":"Jerome Wu <jeromewus@gmail.com>","license":"MIT","bugs":{"url":"https://github.com/ffmpegjs/ffmpeg.js/issues"},"homepage":"https://github.com/ffmpegjs/ffmpeg.js#readme","dependencies":{"@ffmpeg/core":"^0.5.0","idb":"^4.0.5","is-url":"^1.2.4","node-fetch":"^2.6.0","regenerator-runtime":"^0.13.3","resolve-url":"^0.2.1"},"devDependencies":{"@babel/core":"^7.6.4","@babel/preset-env":"^7.6.3","babel-loader":"^8.0.6","cors":"^2.8.5","eslint":"^6.1.0","eslint-config-airbnb-base":"^14.0.0","eslint-plugin-import":"^2.18.2","expect.js":"^0.3.1","express":"^4.17.1","mocha":"^6.2.2","mocha-headless-chrome":"^2.0.3","npm-run-all":"^4.1.5","nyc":"^14.1.1","wait-on":"^3.3.0","webpack":"^4.41.2","webpack-cli":"^3.3.9","webpack-dev-middleware":"^3.7.2"}}')},"83d9":function(e,t){e.exports=(e,t)=>{e.onmessage=({data:e})=>{t(e)}}},"895f":function(e,t,n){const{openDB:r}=n("3f4f"),o=()=>r("/data",21),a=async e=>{const t=await e.get("FILE_DATA","/data/.DUMMY"),n=Object.keys(t).filter(e=>!["mode","timestamp"].includes(e)).pop();return{dataKey:n,mode:t.mode}};e.exports={readFile:async e=>{const t=await o(),{dataKey:n}=await a(t);return(await t.get("FILE_DATA",`/data/${e}`))[n]},writeFile:async(e,t)=>{const n=await o(),{dataKey:r,mode:i}=await a(n);await n.put("FILE_DATA",{[r]:t,mode:i,timestamp:new Date},`/data/${e}`)},deleteFile:async e=>{const t=await o();await t.delete("FILE_DATA",`/data/${e}`)}}},"906b":function(e,t,n){"use strict";n.r(t);var r=n("5993"),o=n.n(r);o()().load().then((function(){return postMessage()}))},"908e":function(e,t){let n=!1;t.logging=n,t.setLogging=e=>{n=e},t.log=(...e)=>n?console.log.apply(this,e):null},a462:function(e,t){e.exports=({workerPath:e,workerBlobURL:t})=>{let n;if(Blob&&URL&&t){const t=new Blob([`importScripts("${e}");`],{type:"application/javascript"});n=new Worker(URL.createObjectURL(t))}else n=new Worker(e);return n}},afc1:function(e,t){let n=0;const r=e=>{const[t,n,r]=e.split(":");return 60*parseFloat(t)*60+60*parseFloat(n)+parseFloat(r)};e.exports=({message:e},t)=>{if("string"===typeof e)if(e.startsWith("  Duration")){const t=e.split(", ")[0].split(": ")[1],o=r(t);(0===n||n>o)&&(n=o)}else if(e.startsWith("frame")){const o=e.split("time=")[1].split(" ")[0],a=r(o);t({ratio:a/n})}else e.startsWith("video:")&&t({ratio:1})}},c39d:function(e,t,n){const r=n("3e15"),o=e=>new Promise((t,n)=>{const r=new FileReader;r.onload=()=>{t(r.result)},r.onerror=({target:{error:{code:e}}})=>{n(Error(`File could not be read! Code=${e}`))},r.readAsArrayBuffer(e)});e.exports=async e=>{let t=e;if("undefined"===typeof e)return"undefined";if("string"===typeof e)if(/data:_data\/([a-zA-Z]*);base64,([^"]*)/.test(e))t=atob(e.split(",")[1]).split("").map(e=>e.charCodeAt(0));else{const n=await fetch(r(e));t=await n.arrayBuffer()}else(e instanceof File||e instanceof Blob)&&(t=await o(e));return new Uint8Array(t)}},caaa:function(e,t){e.exports={logger:()=>{},progress:()=>{}}},f1c1:function(e,t){e.exports=async(e,t)=>{e.postMessage(t)}},f28c:function(e,t){var n,r,o=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}function c(e){if(r===clearTimeout)return clearTimeout(e);if((r===i||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{return r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(function(){try{n="function"===typeof setTimeout?setTimeout:a}catch(e){n=a}try{r="function"===typeof clearTimeout?clearTimeout:i}catch(e){r=i}})();var u,l=[],d=!1,f=-1;function p(){d&&u&&(d=!1,u.length?l=u.concat(l):f=-1,l.length&&m())}function m(){if(!d){var e=s(p);d=!0;var t=l.length;while(t){u=l,l=[];while(++f<t)u&&u[f].run();f=-1,t=l.length}u=null,d=!1,c(e)}}function g(e,t){this.fun=e,this.array=t}function h(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new g(e,t)),1!==l.length||d||s(m)},g.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=h,o.addListener=h,o.once=h,o.off=h,o.removeListener=h,o.removeAllListeners=h,o.emit=h,o.prependListener=h,o.prependOnceListener=h,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}}});
//# sourceMappingURL=31ccb91ed47abff97eeb.worker.js.map